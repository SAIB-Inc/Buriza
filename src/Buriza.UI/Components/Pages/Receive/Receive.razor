@using Buriza.UI.Components.Common
@using Buriza.UI.Components.Controls
@using Buriza.UI.Resources
@using Buriza.Data.Models.Enums

@page "/receive"

@namespace Buriza.UI.Components.Pages

<section class="h-screen">
    <div class="max-[376px]:!p-4 max-[376px]:flex flex-col h-full container !mx-auto !py-16 !overflow-x-visible">
        <div class="max-[376px]:!mb-0 flex justify-between !mb-[75px] min-[376px]:!px-4">
            <div class="flex align-center !gap-2">
                <MudIconButton Icon="@BurizaIcons.ChevronRightIcon"
                    Class="!p-0 [&_.mud-icon-root]:!text-[var(--mud-palette-text-primary)]"
                    OnClick="@(IsAdvancedMode ? OnBackButtonClicked : null)"
                    Href="@(IsAdvancedMode ? null : "/")" />
                <MudText Class="!text-[22px] !font-medium">@(IsAdvancedMode ? "Advanced" : "Your Address")</MudText>
            </div>
            <div class="flex align-center">
                <MudIconButton Icon="@(IsAdvancedMode ? BurizaIcons.CloseSymbolIcon : BurizaIcons.AdvancedSettings2Icon)"
                    Class="!p-0 [&_.mud-icon-root]:!text-[var(--mud-palette-text-primary)]"
                    OnClick="@(IsAdvancedMode ? OnBackButtonClicked : OnAdvancedModeButtonClicked)" />
            </div>
        </div>
        <MudCarousel TData="object" @ref="_carousel" ShowArrows="false" ShowBullets="false" AutoCycle="false"
            EnableSwipeGesture="false" Class="max-[376px]:!flex-1 !h-full">

            @* 1st Slide *@
            <MudCarouselItem Class="max-[376px]:flex flex-col justify-center">
                <div class=" w-full min-[376px]:!px-4">
                    <div class="max-[376px]:!mb-8 relative !mb-11">
                        <MudImage 
                            Alt="" 
                            Src="@Misc.DiamondClusterOrange"
                            Class=" max-[376px]:bottom-[-35px] max-[376px]:left-[15px] !absolute bottom-[-45px] left-[-4px]" 
                        />
                        <MudImage 
                            Alt="QR Code" 
                            Src="@Misc.BurizaQrCode" 
                            Class="max-[376px]:!h-[200px] !h-[250px] !mx-auto" 
                        />

                        <MudImage 
                            Alt="" 
                            Src="@Misc.DiamondClusterPurple" 
                            Class="max-[376px]:!h-[120px] max-[376px]:!w-auto max-[376px]:top-[-54px] max-[376px]:right-[10px] !absolute top-[-67px] right-[-25px]" 
                        />

                    </div>
                    <div class="!px-4">
                        <MudText
                            Class="!text-[22px] !font-semibold"
                            Align="Align.Center">@SelectedAccount?.Name
                        </MudText>
                        <MudText Class="break-words font-light" Align="Align.Center"><span class="font-bold"
                                Align="Align.Center">@SelectedAccount?.Start</span>@SelectedAccount?.Middle<span
                                class="font-bold">@SelectedAccount?.End</span></MudText>
                    </div>
                </div>

                <div class="max-[376px]:w-[calc(100vw-32px)]! max-[376px]:fixed max-[376px]:bottom-4 max-[376px]:h-auto max-[376px]:!py-0 h-[calc(100%-510px)] !pb-4 flex justify-between items-end gap-x-2 overflow-y-auto min-[376px]:!px-4">
                    <BurizaButton Variant="Variant.Filled" Color="Color.Primary">
                        Share QR Code
                    </BurizaButton>
                    <MudIconButton Icon="@BurizaIcons.CopySymbolIcon" Variant="Variant.Filled"
                        Class="!rounded-full !p-2 [&_.mud-icon-root]:!text-[var(--mud-palette-secondary-text)] !bg-[var(--mud-palette-secondary-lighten)]">
                    </MudIconButton>
                </div>

            </MudCarouselItem>

            @* 2nd Slide *@
            <MudCarouselItem>
                <div class="!px-4">
                    <div
                        class="max-[376px]:!p-[13px] w-full flex items-center justify-between !py-4 !px-4 !mb-6 shadow-[var(--mud-elevation-2)] !rounded-[12px] !bg-[var(--mud-palette-lines-inputs)] md:!bg-[var(--mud-palette-dark-text)]">
                        <div class="flex items-center !gap-3">
                            <div class="relative">
                                <div>
                                    <MudImage Alt="Avatar" Src="@Misc.Avatar"
                                        Class="!w-[46px] aspect-square !rounded-full" />
                                </div>
                            </div>
                            <div>
                                <MudText Class="!font-medium">
                                    WalletName1
                                </MudText>
                            </div>
                        </div>
                        <div>
                            <MudIconButton Icon="@BurizaIcons.ChevronLeftIcon" Class="!p-0" />
                        </div>
                    </div>
                </div>

                <div class="max-[376px]:!pb-19 max-[376px]:min-h-[calc(100vh-195px)] max-h-[calc(100vh-314px)] flex flex-col gap-y-3 overflow-y-auto !pb-11 !px-4">
                    @foreach (var account in Accounts)
                    {

                        <MudCard
                            Class="max-[376px]:gap-y-1 flex flex-col gap-y-3 !p-4 !bg-[var(--mud-palette-background-gray)] rounded-xl border border-solid border-[var(--mud-palette-table-lines)] !cursor-pointer shadow-[var(--mud-elevation-2)]"
                            Elevation="0" @onclick="() => OnAccountCardClicked(account.Index)">
                            <div class="flex justify-between items-center">
                                <div class="flex items-center">
                                    <MudImage Alt="Avatar" Src="@account.AvatarUrl"
                                        Class="!w-9 aspect-square !rounded-full !mr-2" />
                                    <MudText Class="font-semibold">@account.Name</MudText>
                                </div>
                                <div>
                                    <MudIconButton Icon="@BurizaIcons.QrScannerIcon"
                                        Class="self-start !p-0 [&_.mud-icon-root]:!text-[var(--mud-palette-text-primary)]" />
                                </div>
                            </div>
                            <div>
                                <MudText Align="Align.Left" Class="!mr-[76px] !text-xs break-words">
                                    <span class="font-bold">@account.Start</span>@account.Middle<span
                                        class="font-bold">@account.End</span>
                                </MudText>
                            </div>
                            <div class="flex justify-between items-center">
                                <MudText Align="Align.Left" Class="!font-semibold !text-xs">@account.DerivationPath
                                </MudText>
                                <MudChip T="object"
                                    Class="@(GetChipColor(account.Status) + " min-w-[63px] max-h-5 !text-[var(--mud-palette-tertiary)]")">
                                    <MudIcon Icon="@GetChipIcon(account.Status)" Class="!w-3 !h-3 !mr-1" />
                                    @switch (account.Status)
                                    {
                                        case AccountStatusType.Used:
                                            <MudText Class="!text-[8px] !font-semibold">Used</MudText>
                                            break;
                                        case AccountStatusType.Unused:
                                            <MudText Class="!text-[8px] !font-semibold">Unused</MudText>
                                            break;
                                        case AccountStatusType.Balance:
                                            <MudText Class="!text-[8px] !font-semibold">@account.Balance.ToString("")</MudText>
                                            break;
                                    }
                                </MudChip>
                            </div>
                        </MudCard>
                    }
                </div>

            </MudCarouselItem>

        </MudCarousel>

    </div>

</section>